## Возможные стратегии мерджинга показателей для нормализации

### 1. Мердж по нормализованному названию региона и году (основной сценарий)

**Ключи:** `name_rus` + `year`

Самый частый случай — присоединение показателя, который меняется и по регионам, и по годам.
Примеры: стоимость фиксированного набора, ИБР, численность населения по годам.

**Формат входных данных:**
- Wide-формат (регионы × годы) — требуется `melt` → long перед мерджем
- Long-формат (регион, год, значение) — мерджится напрямую

**Тип джойна:** `left` (основной датасет слева, показатель справа). `outer` — если нужно сохранить все регионы из обоих источников.

---

### 2. Мердж по нормализованному названию региона (без года)

**Ключи:** `name_rus`

Для статических или редко меняющихся показателей, когда год не важен или берётся одно фиксированное значение.
Примеры: площадь территории, часовой пояс, код ОКТМО, принадлежность к федеральному округу.

**Вариант:** пользователь указывает конкретный год, из wide-таблицы берётся одна колонка.


### 3. Мердж нескольких показателей одновременно (пакетный мердж)

**Сценарий:** пользователь хочет присоединить 5-10 показателей из разных источников за один вызов.

**Подход:**
- Все показатели приводятся к единому long-формату: `name_rus`, `year`, `indicator_name`, `value`
- Или: каждый показатель — отдельная колонка, мердж идёт последовательно/цепочкой
- API: `attach_indicators(df, indicators=[...], on=['name_rus', 'year'])`

**Конфликт имён:** если в разных источниках колонки называются одинаково — автоматическое добавление суффикса или ошибка.

---


### Сводная таблица сценариев

| # | Сценарий | Ключи мерджа | Тип джойна | Доп. логика |
|---|----------|-------------|-----------|-------------|
| 1 | По названию + год | `name_rus` + `year` | left/outer | melt wide→long |
| 2 | По названию (без года) | `name_rus` | left | выбор года / статика |
| 3 | Пакетный мердж | `name_rus` + `year` | left chain | несколько показателей |

---
